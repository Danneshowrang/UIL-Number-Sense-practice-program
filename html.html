<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Sense Practice</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 15px;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            width: 100%;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        h1 i {
            color: #3498db;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .problem-section {
            flex: 2;
            min-width: 300px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .controls-section {
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .problem-card {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .problem-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1f2f6;
        }
        
        .problem-type {
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .problem-number {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .problem-text {
            font-size: 1.8rem;
            margin: 30px 0;
            text-align: center;
            color: #2c3e50;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .answer-section {
            margin-top: 20px;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            font-size: 1.4rem;
            border: 2px solid #dfe6e9;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .answer-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            text-align: center;
            display: none;
        }
        
        .correct {
            background: #d5f4e6;
            color: #27ae60;
            border: 2px solid #2ecc71;
            display: block;
        }
        
        .incorrect {
            background: #ffeaea;
            color: #e74c3c;
            border: 2px solid #e74c3c;
            display: block;
        }
        
        .hint-box {
            background: #fff9e6;
            border-left: 4px solid #f1c40f;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin-top: 20px;
            display: none;
        }
        
        .hint-header {
            font-weight: 600;
            color: #d35400;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .hint-text {
            color: #7f8c8d;
            line-height: 1.5;
        }
        
        .control-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .control-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1f2f6;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn {
            padding: 15px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }
        
        .btn-secondary:hover {
            background: #d5dbdb;
            transform: translateY(-3px);
        }
        
        .btn-success {
            background: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background: #d68910;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .stat {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .category-selector {
            margin-top: 20px;
        }
        
        .category-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .category-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .category-btn {
            padding: 8px 15px;
            background: #ecf0f1;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .category-btn.active {
            background: #3498db;
            color: white;
        }
        
        .category-btn:hover:not(.active) {
            background: #d5dbdb;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
            padding: 20px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .problem-text {
                font-size: 1.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> Number Sense Practice</h1>
            <p class="subtitle">Practice number sense problems from the 2021B test. Improve your mental math and problem-solving skills with instant feedback.</p>
        </header>
        
        <div class="main-content">
            <section class="problem-section">
                <div class="problem-card">
                    <div class="problem-header">
                        <div class="problem-number">Problem #<span id="problem-id">12</span></div>
                        <div class="problem-type" id="problem-category">Statistics</div>
                    </div>
                    
                    <div class="problem-text" id="problem-text">
                        Mode of {1,1,2,3,5,2,1,3,4,7} = 
                    </div>
                    
                    <div class="answer-section">
                        <input type="text" class="answer-input" id="answer-input" placeholder="Enter your answer..." autocomplete="off">
                        <div class="feedback" id="feedback"></div>
                        <div class="hint-box" id="hint-box">
                            <div class="hint-header">
                                <i class="fas fa-lightbulb"></i> Hint
                            </div>
                            <div class="hint-text" id="hint-text">
                                The mode is the most frequent number: 1 appears 3 times
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="controls-section">
                <div class="control-card">
                    <h2 class="control-title"><i class="fas fa-cogs"></i> Controls</h2>
                    <button class="btn btn-primary" id="generate-btn">
                        <i class="fas fa-sync-alt"></i> Generate New Problem
                    </button>
                    <button class="btn btn-success" id="check-btn">
                        <i class="fas fa-check-circle"></i> Check Answer
                    </button>
                    <button class="btn btn-secondary" id="show-hint-btn">
                        <i class="fas fa-question-circle"></i> Show Hint
                    </button>
                    <button class="btn btn-warning" id="show-answer-btn">
                        <i class="fas fa-eye"></i> Show Answer
                    </button>
                </div>
                
                <div class="stats-card">
                    <h2 class="control-title"><i class="fas fa-chart-line"></i> Statistics</h2>
                    <div class="stats-grid">
                        <div class="stat">
                            <div class="stat-value" id="problems-attempted">0</div>
                            <div class="stat-label">Problems Attempted</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="correct-answers">0</div>
                            <div class="stat-label">Correct Answers</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="accuracy-rate">0%</div>
                            <div class="stat-label">Accuracy Rate</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="current-streak">0</div>
                            <div class="stat-label">Current Streak</div>
                        </div>
                    </div>
                    
                    <div class="category-selector">
                        <div class="category-title">Filter by Category:</div>
                        <div class="category-options" id="category-buttons">
                            <button class="category-btn active" data-category="all">All</button>
                            <!-- Categories will be added dynamically -->
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <footer>
            <p>Number Sense Practice Program • Based on 2021B Test Problems • Created with JavaScript</p>
            <p>Use this tool to practice for number sense competitions. Try to solve each problem mentally before checking the answer!</p>
        </footer>
    </div>

    <script>
        // Original JavaScript functions from the provided file
        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }
        
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Problem generator functions (copied from the original file)
        function generateMode() {
            var sets = [
                [[1,1,2,3,5,2,1,3,4,7], 1],
                [[2,3,3,4,4,4,5,5], 4],
                [[1,2,2,3,3,3,4], 3]
            ];
            var choice = randomChoice(sets);
            return {
                problem: "Mode of {" + choice[0].join(",") + "} = ",
                answer: choice[1],
                type: "Statistics",
                hint: "The mode is the most frequent number: " + choice[1] + " appears " + 
                      choice[0].filter(x => x === choice[1]).length + " times"
            };
        }

        function generateSquareRootOfDecimal() {
            var num = randomChoice([3.2, 3.5, 4.5, 5.5]);
            var square = num * num;
            return {
                problem: num + " is the square root of ______ (decimal)",
                answer: square,
                type: "Squares & Roots",
                hint: num + "² = " + square
            };
        }

        function generateSquareRemainder() {
            var num = randomInt(20, 60);
            var divisor = randomChoice([4, 5, 7, 8]);
            return {
                problem: num + "² ÷ " + divisor + " has remainder ______",
                answer: (num * num) % divisor,
                type: "Remainders",
                hint: num + "² = " + (num*num) + ", " + (num*num) + " ÷ " + divisor + " = " + 
                      Math.floor((num*num)/divisor) + " remainder " + ((num*num) % divisor)
            };
        }

        function generateSystemSubstitution() {
            var p = randomInt(40, 80);
            var diff = randomInt(10, 20);
            var q = (p - diff) / 2;
            p = q + diff;
            return {
                problem: "Let " + (p+q) + " = p + q, where p = q + " + diff + ". Find q.",
                answer: q,
                type: "Algebra",
                hint: "Substitute: q + " + diff + " + q = " + (p+q) + " → 2q = " + (p+q-diff) + " → q = " + q
            };
        }

        function generateBase12WithLetters() {
            var num = randomInt(200, 300);
            var temp = num;
            var digits = [];
            while (temp > 0) {
                var digit = temp % 12;
                digits.unshift(digit < 10 ? digit : String.fromCharCode(65 + digit - 10));
                temp = Math.floor(temp / 12);
            }
            var base12 = digits.join('');
            return {
                problem: num + " base 10 = ______ base 12",
                answer: base12,
                type: "Base Conversion",
                hint: num + " in base 12: " + base12
            };
        }

        function generateRadicalSimplify() {
            var a = randomInt(2, 5);
            var b = randomInt(3, 12);
            var c = a*a*3;
            var d = b*b*3;
            return {
                problem: a + "√3 + √" + d + " = √k, then k = ______",
                answer: (a*a*3 + b*b*3),
                type: "Radicals",
                hint: a + "√3 = √" + (a*a*3) + ", √" + d + " = √" + (b*b*3) + ", sum = √" + (a*a*3 + b*b*3)
            };
        }

        function generatePerfectSquareCondition() {
            var coefficient = randomChoice([5, 7, 11]);
            var constant = randomChoice([1, 4, 9]);
            var k = randomInt(4, 10);
            var square = coefficient * k + constant;
            var root = Math.floor(Math.sqrt(square));
            square = root * root;
            k = (square - constant) / coefficient;
            return {
                problem: "Smallest integer k > 3 where " + coefficient + "k + " + constant + " is a perfect square: ______",
                answer: k,
                type: "Number Theory",
                hint: coefficient + "k + " + constant + " = " + square + " = " + root + "², so k = " + k
            };
        }

        function generateSeriesRatio() {
            var n = 7;
            var sumSquares = n*(n+1)*(2*n+1)/6;
            var sumTriangular = n*(n+1)*(n+2)/6;
            return {
                problem: "(1²+2²+...+7²)/(1+3+6+...+28) = ______",
                answer: sumSquares / sumTriangular,
                type: "Series",
                hint: "Numerator: 1+4+9+16+25+36+49 = " + sumSquares + 
                      ", Denominator: 1+3+6+10+15+21+28 = " + sumTriangular
            };
        }

        function generateLogFunction() {
            var base = randomChoice([3, 4, 5]);
            var x = base * base;
            return {
                problem: "f(x) = 2x + log" + base + "(x), find f(" + x + ")",
                answer: 2*x + 2,
                type: "Logarithms",
                hint: "2×" + x + " = " + (2*x) + ", log" + base + "(" + x + ") = 2, sum = " + (2*x+2)
            };
        }

        function generateDeterminant() {
            var a = 2, b = 3, c = randomInt(-3, 3), d = 1.5;
            var determinant = a*d - b*c;
            var target = randomInt(4, 8);
            c = (a*d - target) / b;
            return {
                problem: "Determinant of [[2,3],[" + (-c) + ",1.5]] = 4, find k where k = " + (-c),
                answer: -c,
                type: "Matrices",
                hint: "2×1.5 - 3×(" + (-c) + ") = 3 + " + (3*c) + " = 4 → " + (3*c) + " = 1"
            };
        }
        
        // Array of all problem generator functions
        const problemGenerators = [
            { func: generateMode, id: 12 },
            { func: generateSquareRootOfDecimal, id: 21 },
            { func: generateSquareRemainder, id: 18 },
            { func: generateSystemSubstitution, id: 26 },
            { func: generateBase12WithLetters, id: 27 },
            { func: generateRadicalSimplify, id: 38 },
            { func: generatePerfectSquareCondition, id: 39 },
            { func: generateSeriesRatio, id: 52 },
            { func: generateLogFunction, id: 53 },
            { func: generateDeterminant, id: 69 }
        ];
        
        // Application state
        let currentProblem = null;
        let stats = {
            problemsAttempted: 0,
            correctAnswers: 0,
            currentStreak: 0,
            bestStreak: 0
        };
        
        let selectedCategory = 'all';
        let problemIdCounter = 1;
        
        // DOM elements
        const problemTextEl = document.getElementById('problem-text');
        const problemIdEl = document.getElementById('problem-id');
        const problemCategoryEl = document.getElementById('problem-category');
        const answerInputEl = document.getElementById('answer-input');
        const feedbackEl = document.getElementById('feedback');
        const hintBoxEl = document.getElementById('hint-box');
        const hintTextEl = document.getElementById('hint-text');
        const generateBtn = document.getElementById('generate-btn');
        const checkBtn = document.getElementById('check-btn');
        const showHintBtn = document.getElementById('show-hint-btn');
        const showAnswerBtn = document.getElementById('show-answer-btn');
        const categoryButtonsEl = document.getElementById('category-buttons');
        
        // Stats display elements
        const problemsAttemptedEl = document.getElementById('problems-attempted');
        const correctAnswersEl = document.getElementById('correct-answers');
        const accuracyRateEl = document.getElementById('accuracy-rate');
        const currentStreakEl = document.getElementById('current-streak');
        
        // Initialize the application
        function init() {
            loadStats();
            setupCategoryButtons();
            generateNewProblem();
            setupEventListeners();
            updateStatsDisplay();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            generateBtn.addEventListener('click', generateNewProblem);
            checkBtn.addEventListener('click', checkAnswer);
            showHintBtn.addEventListener('click', showHint);
            showAnswerBtn.addEventListener('click', showAnswer);
            answerInputEl.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    checkAnswer();
                }
            });
        }
        
        // Set up category filter buttons
        function setupCategoryButtons() {
            // Get all unique categories
            const categories = [...new Set(problemGenerators.map(p => p.func().type))];
            
            // Add "All" button
            const allButton = categoryButtonsEl.querySelector('[data-category="all"]');
            
            // Add category buttons
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                button.textContent = category;
                button.dataset.category = category;
                button.addEventListener('click', () => {
                    // Update active button
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    button.classList.add('active');
                    
                    // Update selected category
                    selectedCategory = category;
                    
                    // Generate a new problem from this category
                    generateNewProblem();
                });
                
                categoryButtonsEl.appendChild(button);
            });
        }
        
        // Generate a new problem
        function generateNewProblem() {
            problemIdCounter++;
            
            // Filter generators by selected category if not "all"
            let filteredGenerators = problemGenerators;
            if (selectedCategory !== 'all') {
                filteredGenerators = problemGenerators.filter(p => p.func().type === selectedCategory);
            }
            
            // Select a random generator from filtered list
            const generator = randomChoice(filteredGenerators);
            currentProblem = generator.func();
            currentProblem.id = generator.id;
            
            // Update UI
            problemTextEl.textContent = currentProblem.problem;
            problemIdEl.textContent = generator.id;
            problemCategoryEl.textContent = currentProblem.type;
            
            // Clear previous feedback and hint
            feedbackEl.className = 'feedback';
            feedbackEl.textContent = '';
            hintBoxEl.style.display = 'none';
            answerInputEl.value = '';
            answerInputEl.focus();
            
            // Update stats display
            updateStatsDisplay();
        }
        
        // Check the user's answer
        function checkAnswer() {
            if (!currentProblem) return;
            
            const userAnswer = answerInputEl.value.trim();
            if (!userAnswer) {
                feedbackEl.className = 'feedback';
                feedbackEl.textContent = 'Please enter an answer first.';
                feedbackEl.style.display = 'block';
                return;
            }
            
            // Convert to appropriate type for comparison
            let correctAnswer = currentProblem.answer.toString();
            let userAnswerFormatted = userAnswer;
            
            // Try to handle decimal answers with potential rounding
            if (!isNaN(currentProblem.answer) && !isNaN(userAnswer)) {
                // Handle floating point comparison for numeric answers
                const correctNum = parseFloat(currentProblem.answer);
                const userNum = parseFloat(userAnswer);
                
                // Check if they're essentially the same (accounting for floating point issues)
                if (Math.abs(correctNum - userNum) < 0.0001) {
                    userAnswerFormatted = correctAnswer;
                }
            }
            
            // Check if answer is correct
            const isCorrect = userAnswerFormatted === correctAnswer;
            
            // Update stats
            stats.problemsAttempted++;
            if (isCorrect) {
                stats.correctAnswers++;
                stats.currentStreak++;
                if (stats.currentStreak > stats.bestStreak) {
                    stats.bestStreak = stats.currentStreak;
                }
                
                feedbackEl.className = 'feedback correct';
                feedbackEl.innerHTML = `<i class="fas fa-check-circle"></i> Correct! Well done.`;
            } else {
                stats.currentStreak = 0;
                
                feedbackEl.className = 'feedback incorrect';
                feedbackEl.innerHTML = `<i class="fas fa-times-circle"></i> Incorrect. Try again or check the hint.`;
            }
            
            // Save stats and update display
            saveStats();
            updateStatsDisplay();
            
            // Show hint box if answer is incorrect
            if (!isCorrect) {
                hintBoxEl.style.display = 'block';
            }
        }
        
        // Show hint for current problem
        function showHint() {
            if (!currentProblem) return;
            
            hintTextEl.textContent = currentProblem.hint;
            hintBoxEl.style.display = 'block';
        }
        
        // Show the correct answer
        function showAnswer() {
            if (!currentProblem) return;
            
            answerInputEl.value = currentProblem.answer;
            feedbackEl.className = 'feedback incorrect';
            feedbackEl.innerHTML = `<i class="fas fa-eye"></i> Answer shown: ${currentProblem.answer}`;
            feedbackEl.style.display = 'block';
            
            // Update stats (counts as incorrect)
            stats.problemsAttempted++;
            stats.currentStreak = 0;
            saveStats();
            updateStatsDisplay();
        }
        
        // Update stats display
        function updateStatsDisplay() {
            problemsAttemptedEl.textContent = stats.problemsAttempted;
            correctAnswersEl.textContent = stats.correctAnswers;
            
            const accuracy = stats.problemsAttempted > 0 
                ? Math.round((stats.correctAnswers / stats.problemsAttempted) * 100) 
                : 0;
            accuracyRateEl.textContent = `${accuracy}%`;
            
            currentStreakEl.textContent = stats.currentStreak;
        }
        
        // Load stats from localStorage
        function loadStats() {
            const savedStats = localStorage.getItem('numberSenseStats');
            if (savedStats) {
                stats = JSON.parse(savedStats);
            }
        }
        
        // Save stats to localStorage
        function saveStats() {
            localStorage.setItem('numberSenseStats', JSON.stringify(stats));
        }
        
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>